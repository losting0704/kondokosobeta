<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <link rel="manifest" href="manifest.json" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>乾燥機數據紀錄器</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link rel="stylesheet" href="./css/style.css" />
  </head>

  <body>
    <div class="container">
      <h1>乾燥機數據紀錄器</h1>

      <div class="radio-group">
        <label class="custom-radio">
          <input
            type="radio"
            name="recordType"
            value="evaluationTeam"
            id="radioEvaluationTeam"
            checked
          />
          <span class="radio-indicator"></span>
          <span class="radio-label-text">評價TEAM用</span>
        </label>
        <label class="custom-radio">
          <input
            type="radio"
            name="recordType"
            value="conditionSetting"
            id="radioConditionSetting"
          />
          <span class="radio-indicator"></span>
          <span class="radio-label-text">條件設定用</span>
        </label>
      </div>

      <h2 class="section-header accordion-toggle">基本資訊</h2>
      <div class="accordion-content">
        <div class="form-section">
          <div class="form-column">
            <div class="form-group">
              <label for="dateTime">記錄日期時間：</label>
              <div class="datetime-group">
                <input
                  type="datetime-local"
                  id="dateTime"
                  class="styled-input"
                  required
                  data-field-name="記錄日期時間"
                />
                <button id="setNowBtn" class="now-button" title="設為現在時間">
                  現在
                </button>
              </div>
              <span class="error-message" id="error_dateTime"></span>
            </div>
            <div class="form-group">
              <label for="remark">備註:</label>
              <textarea
                id="remark"
                class="styled-textarea"
                placeholder="備註"
                data-field-name="備註"
              ></textarea>
              <span class="error-message" id="error_remark"></span>
            </div>
          </div>
          <div class="form-column">
            <div class="form-group">
              <label for="dryerModelSelect">選擇乾燥機型號：</label>
              <select id="dryerModelSelect" class="styled-input"></select>
            </div>
            <div class="form-group">
              <label>RTO啟用狀態：</label>
              <div
                class="radio-group"
                style="
                  background-color: transparent;
                  box-shadow: none;
                  justify-content: flex-start;
                  padding: 5px 0;
                "
              >
                <label class="custom-radio">
                  <input
                    type="radio"
                    name="rtoStatus"
                    value="yes"
                    id="rtoYes"
                  />
                  <span class="radio-indicator"></span>
                  <span class="radio-label-text">有</span>
                </label>
                <label class="custom-radio">
                  <input
                    type="radio"
                    name="rtoStatus"
                    value="no"
                    id="rtoNo"
                    checked
                  />
                  <span class="radio-indicator"></span>
                  <span class="radio-label-text">無</span>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label>升溫啟用狀態：</label>
              <div
                class="radio-group"
                style="
                  background-color: transparent;
                  box-shadow: none;
                  justify-content: flex-start;
                  padding: 5px 0;
                "
              >
                <label class="custom-radio">
                  <input
                    type="radio"
                    name="heatingStatus"
                    value="yes"
                    id="heatingYes"
                  />
                  <span class="radio-indicator"></span>
                  <span class="radio-label-text">有</span>
                </label>
                <label class="custom-radio">
                  <input
                    type="radio"
                    name="heatingStatus"
                    value="no"
                    id="heatingNo"
                    checked
                  />
                  <span class="radio-indicator"></span>
                  <span class="radio-label-text">無</span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="common_tempSetting" class="record-section">
        <h2 class="section-header accordion-toggle">溫度設定</h2>
        <div class="accordion-content">
          <div class="input-grid" id="tempSettingGrid">
            <div class="form-group">
              <label for="set_temp_chamber1_supply"
                >１室給氣<small>(℃)：</small></label
              ><input
                type="number"
                id="set_temp_chamber1_supply"
                class="styled-input"
                step="0.1"
                placeholder="１室給氣"
                data-field-name="設定_１室給氣 (℃)"
              /><span
                class="error-message"
                id="error_set_temp_chamber1_supply"
              ></span>
            </div>
            <div class="form-group">
              <label for="set_temp_chamber1_upper_heat"
                >１室上部熱煤<small>(℃)：</small></label
              ><input
                type="number"
                id="set_temp_chamber1_upper_heat"
                class="styled-input"
                step="0.1"
                placeholder="１室上部熱煤"
                data-field-name="設定_１室上部熱煤 (℃)"
              /><span
                class="error-message"
                id="error_set_temp_chamber1_upper_heat"
              ></span>
            </div>
            <div class="form-group">
              <label for="set_temp_chamber1_lower_heat"
                >１室下部熱煤<small>(℃)：</small></label
              ><input
                type="number"
                id="set_temp_chamber1_lower_heat"
                class="styled-input"
                step="0.1"
                placeholder="１室下部熱煤"
                data-field-name="設定_１室下部熱煤 (℃)"
              /><span
                class="error-message"
                id="error_set_temp_chamber1_lower_heat"
              ></span>
            </div>
            <div class="form-group">
              <label for="set_temp_chamber2_supply"
                >２室給氣<small>(℃)：</small></label
              ><input
                type="number"
                id="set_temp_chamber2_supply"
                class="styled-input"
                step="0.1"
                placeholder="２室給氣"
                data-field-name="設定_２室給氣 (℃)"
              /><span
                class="error-message"
                id="error_set_temp_chamber2_supply"
              ></span>
            </div>
            <div class="form-group">
              <label for="set_temp_chamber2_right_heat"
                >２室右熱煤<small>(℃)：</small></label
              ><input
                type="number"
                id="set_temp_chamber2_right_heat"
                class="styled-input"
                step="0.1"
                placeholder="２室右熱煤"
                data-field-name="設定_２室右熱煤 (℃)"
              /><span
                class="error-message"
                id="error_set_temp_chamber2_right_heat"
              ></span>
            </div>
            <div class="form-group">
              <label for="set_temp_chamber2_middle_heat"
                >２室中熱煤<small>(℃)：</small></label
              ><input
                type="number"
                id="set_temp_chamber2_middle_heat"
                class="styled-input"
                step="0.1"
                placeholder="２室中熱煤"
                data-field-name="設定_２室中熱煤 (℃)"
              /><span
                class="error-message"
                id="error_set_temp_chamber2_middle_heat"
              ></span>
            </div>
            <div class="form-group">
              <label for="set_temp_chamber2_left_heat"
                >２室左熱煤<small>(℃)：</small></label
              ><input
                type="number"
                id="set_temp_chamber2_left_heat"
                class="styled-input"
                step="0.1"
                placeholder="２室左熱煤"
                data-field-name="設定_２室左熱煤 (℃)"
              /><span
                class="error-message"
                id="error_set_temp_chamber2_left_heat"
              ></span>
            </div>
          </div>
        </div>
      </div>
      <div
        id="evaluationTeam_recorder1"
        class="record-section"
        data-type="evaluationTeam"
      >
        <h2 class="section-header accordion-toggle">實測第一紀錄器</h2>
        <div class="accordion-content">
          <div class="input-grid" id="evaluationTeam_recorder1_grid">
            <div class="form-group">
              <label for="recorder1_chamber1_lower"
                >1室下<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber1_lower"
                class="styled-input"
                step="0.1"
                placeholder="1室下"
                data-field-name="實測第一紀錄器_1室下 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber1_lower"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder1_chamber1_upper"
                >1室上<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber1_upper"
                class="styled-input"
                step="0.1"
                placeholder="1室上"
                data-field-name="實測第一紀錄器_1室上 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber1_upper"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder1_chamber1_supply"
                >1室給氣<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber1_supply"
                class="styled-input"
                step="0.1"
                placeholder="1室給氣"
                data-field-name="實測第一紀錄器_1室給氣 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber1_supply"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder1_chamber2_supply"
                >2室給氣<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber2_supply"
                class="styled-input"
                step="0.1"
                placeholder="2室給氣"
                data-field-name="實測第一紀錄器_2室給氣 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber2_supply"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder1_chamber1_lower_right"
                >1下右<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber1_lower_right"
                class="styled-input"
                step="0.1"
                placeholder="1下右"
                data-field-name="實測第一紀錄器_1下右 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber1_lower_right"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder1_chamber1_lower_middle"
                >1下中<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber1_lower_middle"
                class="styled-input"
                step="0.1"
                placeholder="1下中"
                data-field-name="實測第一紀錄器_1下中 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber1_lower_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder1_chamber1_lower_left"
                >1下左<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber1_lower_left"
                class="styled-input"
                step="0.1"
                placeholder="1下左"
                data-field-name="實測第一紀錄器_1下左 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber1_lower_left"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder1_chamber1_middle_middle"
                >1中中<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber1_middle_middle"
                class="styled-input"
                step="0.1"
                placeholder="1中中"
                data-field-name="實測第一紀錄器_1中中 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber1_middle_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder1_chamber1_upper_right"
                >1上右<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber1_upper_right"
                class="styled-input"
                step="0.1"
                placeholder="1上右"
                data-field-name="實測第一紀錄器_1上右 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber1_upper_right"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder1_chamber1_upper_middle"
                >1上中<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber1_upper_middle"
                class="styled-input"
                step="0.1"
                placeholder="1上中"
                data-field-name="實測第一紀錄器_1上中 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber1_upper_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder1_chamber1_upper_left"
                >1上左<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder1_chamber1_upper_left"
                class="styled-input"
                step="0.1"
                placeholder="1上左"
                data-field-name="實測第一紀錄器_1上左 (℃)"
              /><span
                class="error-message"
                id="error_recorder1_chamber1_upper_left"
              ></span>
            </div>
          </div>
        </div>
      </div>
      <div
        id="evaluationTeam_recorder2"
        class="record-section"
        data-type="evaluationTeam"
      >
        <h2 class="section-header accordion-toggle">實測第二紀錄器</h2>
        <div class="accordion-content">
          <div class="input-grid" id="evaluationTeam_recorder2_grid">
            <div class="form-group">
              <label for="recorder2_chamber2_upper_right"
                >2上右<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder2_chamber2_upper_right"
                class="styled-input"
                step="0.1"
                placeholder="2上右"
                data-field-name="實測第二紀錄器_2上右 (℃)"
              /><span
                class="error-message"
                id="error_recorder2_chamber2_upper_right"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder2_chamber2_upper_middle"
                >2上中<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder2_chamber2_upper_middle"
                class="styled-input"
                step="0.1"
                placeholder="2上中"
                data-field-name="實測第二紀錄器_2上中 (℃)"
              /><span
                class="error-message"
                id="error_recorder2_chamber2_upper_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder2_chamber2_upper_left"
                >2上左<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder2_chamber2_upper_left"
                class="styled-input"
                step="0.1"
                placeholder="2上左"
                data-field-name="實測第二紀錄器_2上左 (℃)"
              /><span
                class="error-message"
                id="error_recorder2_chamber2_upper_left"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder2_chamber2_room_right"
                >2室右<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder2_chamber2_room_right"
                class="styled-input"
                step="0.1"
                placeholder="2室右"
                data-field-name="實測第二紀錄器_2室右 (℃)"
              /><span
                class="error-message"
                id="error_recorder2_chamber2_room_right"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder2_chamber2_room_middle"
                >2室中<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder2_chamber2_room_middle"
                class="styled-input"
                step="0.1"
                placeholder="2室中"
                data-field-name="實測第二紀錄器_2室中 (℃)"
              /><span
                class="error-message"
                id="error_recorder2_chamber2_room_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder2_chamber2_room_left"
                >2室左<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder2_chamber2_room_left"
                class="styled-input"
                step="0.1"
                placeholder="2室左"
                data-field-name="實測第二紀錄器_2室左 (℃)"
              /><span
                class="error-message"
                id="error_recorder2_chamber2_room_left"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder2_chamber2_middle_middle"
                >2中中<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder2_chamber2_middle_middle"
                class="styled-input"
                step="0.1"
                placeholder="2中中"
                data-field-name="實測第二紀錄器_2中中 (℃)"
              /><span
                class="error-message"
                id="error_recorder2_chamber2_middle_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder2_chamber2_lower_right"
                >2下右<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder2_chamber2_lower_right"
                class="styled-input"
                step="0.1"
                placeholder="2下右"
                data-field-name="實測第二紀錄器_2下右 (℃)"
              /><span
                class="error-message"
                id="error_recorder2_chamber2_lower_right"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder2_chamber2_lower_middle"
                >2下中<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder2_chamber2_lower_middle"
                class="styled-input"
                step="0.1"
                placeholder="2下中"
                data-field-name="實測第二紀錄器_2下中 (℃)"
              /><span
                class="error-message"
                id="error_recorder2_chamber2_lower_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="recorder2_chamber2_lower_left"
                >2下左<small>(℃)：</small></label
              ><input
                type="number"
                id="recorder2_chamber2_lower_left"
                class="styled-input"
                step="0.1"
                placeholder="2下左"
                data-field-name="實測第二紀錄器_2下左 (℃)"
              /><span
                class="error-message"
                id="error_recorder2_chamber2_lower_left"
              ></span>
            </div>
          </div>
        </div>
      </div>
      <div
        id="evaluationTeam_airAndExternal"
        class="record-section"
        data-type="evaluationTeam"
      >
        <h2 class="section-header accordion-toggle">風量設定&机外顯示</h2>
        <div class="accordion-content">
          <div class="input-grid" id="evaluationTeam_airAndExternal_grid"></div>
        </div>
      </div>

      <div
        id="evaluationTeam_technicalWind"
        class="record-section"
        data-type="evaluationTeam"
      >
        <h2 class="section-header header-dark-bg accordion-toggle">
          風量量測<span class="tooltip-container"
            ><span
              class="tooltip-trigger"
              tabindex="0"
              role="button"
              aria-describedby="tooltip-air-volume-formula"
              >?</span
            ><span
              class="tooltip-text"
              id="tooltip-air-volume-formula"
              role="tooltip"
              >風量公式: [273 / (273 + 溫度)] * 面積 * 風速 * 60</span
            ></span
          >
        </h2>
        <div class="accordion-content">
          <div class="air-volume-grid" id="airVolumeGrid"></div>
        </div>
      </div>
      <div
        id="evaluationTeam_technicalTemp"
        class="record-section"
        data-type="evaluationTeam"
      >
        <h2 class="section-header accordion-toggle">技術溫測實溫</h2>
        <div class="accordion-content">
          <div class="temp-grid" id="techTempGrid"></div>
        </div>
      </div>

      <div
        id="common_fanSetting"
        class="record-section"
        data-type="conditionSetting"
      >
        <h2 class="section-header accordion-toggle">FAN設定</h2>
        <div class="accordion-content">
          <div class="input-grid" id="fanSettingGrid">
            <div class="form-group">
              <label for="fan_setting_chamber1_supply"
                >１室給氣<small>(Hz/RPM)：</small></label
              ><input
                type="number"
                id="fan_setting_chamber1_supply"
                class="styled-input"
                step="0.1"
                placeholder="１室給氣"
                data-field-name="FAN_１室給氣 (Hz/RPM)"
              /><span
                class="error-message"
                id="error_fan_setting_chamber1_supply"
              ></span>
            </div>
            <div class="form-group">
              <label for="fan_setting_chamber1_exhaust"
                >１室排氣<small>(Hz/RPM)：</small></label
              ><input
                type="number"
                id="fan_setting_chamber1_exhaust"
                class="styled-input"
                step="0.1"
                placeholder="１室排氣"
                data-field-name="FAN_１室排氣 (Hz/RPM)"
              /><span
                class="error-message"
                id="error_fan_setting_chamber1_exhaust"
              ></span>
            </div>
            <div class="form-group">
              <label for="fan_setting_chamber2_supply"
                >２室給氣<small>(Hz/RPM)：</small></label
              ><input
                type="number"
                id="fan_setting_chamber2_supply"
                class="styled-input"
                step="0.1"
                placeholder="２室給氣"
                data-field-name="FAN_２室給氣 (Hz/RPM)"
              /><span
                class="error-message"
                id="error_fan_setting_chamber2_supply"
              ></span>
            </div>
            <div class="form-group">
              <label for="fan_setting_chamber2_exhaust"
                >２室排氣<small>(Hz/RPM)：</small></label
              ><input
                type="number"
                id="fan_setting_chamber2_exhaust"
                class="styled-input"
                step="0.1"
                placeholder="１室排氣"
                data-field-name="FAN_２室排氣 (Hz/RPM)"
              /><span
                class="error-message"
                id="error_fan_setting_chamber2_exhaust"
              ></span>
            </div>
            <div class="form-group">
              <label for="fan_setting_upper_ac_exhaust"
                >上部AC排氣<small>(Hz/RPM)：</small></label
              ><input
                type="number"
                id="fan_setting_upper_ac_exhaust"
                class="styled-input"
                step="0.1"
                placeholder="上部AC排氣"
                data-field-name="FAN_上部AC排氣 (Hz/RPM)"
              /><span
                class="error-message"
                id="error_fan_setting_upper_ac_exhaust"
              ></span>
            </div>
            <div class="form-group">
              <label for="fan_setting_upper_ac_supply"
                >上部AC給氣<small>(Hz/RPM)：</small></label
              ><input
                type="number"
                id="fan_setting_upper_ac_supply"
                class="styled-input"
                step="0.1"
                placeholder="上部AC給氣"
                data-field-name="FAN_上部AC給氣 (Hz/RPM)"
              /><span
                class="error-message"
                id="error_fan_setting_upper_ac_supply"
              ></span>
            </div>
            <div class="form-group">
              <label for="fan_setting_lower_ac_exhaust"
                >下部AC排氣<small>(Hz/RPM)：</small></label
              ><input
                type="number"
                id="fan_setting_lower_ac_exhaust"
                class="styled-input"
                step="0.1"
                placeholder="下部AC排氣"
                data-field-name="FAN_下部AC排氣 (Hz/RPM)"
              /><span
                class="error-message"
                id="error_fan_setting_lower_ac_exhaust"
              ></span>
            </div>
            <div class="form-group">
              <label for="fan_setting_lower_ac_supply"
                >下部AC給氣<small>(Hz/RPM)：</small></label
              ><input
                type="number"
                id="fan_setting_lower_ac_supply"
                class="styled-input"
                step="0.1"
                placeholder="下部AC給氣"
                data-field-name="FAN_下部AC給氣 (Hz/RPM)"
              /><span
                class="error-message"
                id="error_fan_setting_lower_ac_supply"
              ></span>
            </div>
          </div>
        </div>
      </div>

      <div
        id="common_dryerTemp"
        class="record-section"
        data-type="conditionSetting"
      >
        <h2 class="section-header accordion-toggle">乾燥機內實溫</h2>
        <div class="accordion-content">
          <div class="input-grid" id="dryerTempGrid">
            <div class="form-group">
              <label for="dryer_chamber1_lower_left"
                >１室下 左<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber1_lower_left"
                class="styled-input"
                step="0.1"
                placeholder="１室下 左"
                data-field-name="乾燥機內實溫_１室下 左 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber1_lower_left"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber1_lower_middle"
                >１室下 中<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber1_lower_middle"
                class="styled-input"
                step="0.1"
                placeholder="１室下 中"
                data-field-name="乾燥機內實溫_１室下 中 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber1_lower_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber1_lower_right"
                >１室下 右<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber1_lower_right"
                class="styled-input"
                step="0.1"
                placeholder="１室下 右"
                data-field-name="乾燥機內實溫_１室下 右 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber1_lower_right"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber1_upper_left"
                >１室上 左<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber1_upper_left"
                class="styled-input"
                step="0.1"
                placeholder="１室上 左"
                data-field-name="乾燥機內實溫_１室上 左 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber1_upper_left"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber1_upper_middle"
                >１室上 中<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber1_upper_middle"
                class="styled-input"
                step="0.1"
                placeholder="１室上 中"
                data-field-name="乾燥機內實溫_１室上 中 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber1_upper_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber1_upper_right"
                >１室上 右<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber1_upper_right"
                class="styled-input"
                step="0.1"
                placeholder="１室上 右"
                data-field-name="乾燥機內實溫_１室上 右 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber1_upper_right"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber2_upper_left"
                >２室上 左<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber2_upper_left"
                class="styled-input"
                step="0.1"
                placeholder="２室上 左"
                data-field-name="乾燥機內實溫_２室上 左 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber2_upper_left"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber2_upper_middle"
                >２室上 中<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber2_upper_middle"
                class="styled-input"
                step="0.1"
                placeholder="２室上 中"
                data-field-name="乾燥機內實溫_２室上 中 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber2_upper_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber2_upper_right"
                >２室上 右<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber2_upper_right"
                class="styled-input"
                step="0.1"
                placeholder="２室上 右"
                data-field-name="乾燥機內實溫_２室上 右 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber2_upper_right"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber2_lower_left"
                >２室下 左<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber2_lower_left"
                class="styled-input"
                step="0.1"
                placeholder="２室下 左"
                data-field-name="乾燥機內實溫_２室下 左 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber2_lower_left"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber2_lower_middle"
                >２室下 中<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber2_lower_middle"
                class="styled-input"
                step="0.1"
                placeholder="２室下 中"
                data-field-name="乾燥機內實溫_２室下 中 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber2_lower_middle"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_chamber2_lower_right"
                >２室下 右<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_chamber2_lower_right"
                class="styled-input"
                step="0.1"
                placeholder="２室下 右"
                data-field-name="乾燥機內實溫_２室下 右 (°C)"
              /><span
                class="error-message"
                id="error_dryer_chamber2_lower_right"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_top_roll_chamber"
                >Top Roll室<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_top_roll_chamber"
                class="styled-input"
                step="0.1"
                placeholder="Top Roll室"
                data-field-name="乾燥機內實溫_Top Roll室 (°C)"
              /><span
                class="error-message"
                id="error_dryer_top_roll_chamber"
              ></span>
            </div>
            <div class="form-group">
              <label for="dryer_impregnation_chamber"
                >含浸室<small>(℃)：</small></label
              ><input
                type="number"
                id="dryer_impregnation_chamber"
                class="styled-input"
                step="0.1"
                placeholder="含浸室"
                data-field-name="乾燥機內實溫_含浸室 (°C)"
              /><span
                class="error-message"
                id="error_dryer_impregnation_chamber"
              ></span>
            </div>
          </div>
        </div>
      </div>

      <div
        id="conditionSetting_damperOpening"
        class="record-section"
        data-type="conditionSetting"
      >
        <h2 class="section-header dark-bg-context accordion-toggle">
          給排氣damper開度<button
            id="viewDamperLayoutBtn"
            class="icon-btn"
            title="查看Damper佈局圖"
            data-image-caption="Damper 佈局圖"
          >
            <svg
              viewBox="0 0 24 24"
              stroke="currentColor"
              fill="none"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
          </button>
        </h2>
        <div class="accordion-content">
          <div class="input-grid" id="damperOpeningGrid"></div>
        </div>
      </div>

      <div id="hmi-sections-container"></div>

      <div id="common_buttons" class="button-group">
        <button id="saveDataBtn" class="button button-save">
          <svg
            class="icon"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line></svg
          ><span>新增數據</span>
        </button>
        <button
          id="updateDataBtn"
          class="button button-update"
          style="display: none"
        >
          <svg
            class="icon"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <polyline points="20 6 9 17 4 12"></polyline></svg
          ><span>更新數據</span>
        </button>
        <button
          id="cancelEditBtn"
          class="button button-cancel"
          style="display: none"
        >
          <svg
            class="icon"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line></svg
          ><span>取消編輯</span>
        </button>
        <button id="exportCsvBtn" class="button button-export">
          <svg
            class="icon"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line></svg
          ><span>匯出 CSV</span>
        </button>
        <button id="importCsvBtn" class="button button-import">
          <svg
            class="icon"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="17 8 12 3 7 8"></polyline>
            <line x1="12" y1="3" x2="12" y2="15"></line></svg
          ><span>匯入 CSV</span>
        </button>
        <input
          type="file"
          id="csvFileInput"
          accept=".csv"
          style="display: none"
        />
        <button id="exportChartBtn" class="button button-info">
          <svg
            class="icon"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line></svg
          ><span>匯出技術溫測圖</span>
        </button>
        <button
          id="clearDataBtn"
          class="button button-clear button-clear-special"
        >
          <svg
            class="icon"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <polyline points="3 6 5 6 21 6"></polyline>
            <path
              d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
            ></path>
            <line x1="10" y1="11" x2="10" y2="17"></line>
            <line x1="14" y1="11" x2="14" y2="17"></line></svg
          ><span>清除所有數據</span>
        </button>
      </div>

      <div
        class="workflow-section"
        style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ccc"
      >
        <h2 class="section-header">資料庫管理流程</h2>
        <div class="button-group">
          <button
            id="loadMasterDbBtn"
            class="button button-save"
            title="(通用) 讀取主資料庫 all_records.json，將所有歷史紀錄同步到此裝置"
          >
            載入主資料庫
          </button>
          <button
            id="createMasterDbBtn"
            class="button button-import"
            title="(筆電用) 選擇多個歷史CSV，建立新的主資料庫 all_records.json"
          >
            從歷史CSV建立主資料庫
          </button>
          <button
            id="mergeToMasterBtn"
            class="button button-update"
            title="(筆電用) 將平板匯出的每日紀錄合併進主資料庫 all_records.json"
          >
            合併資料至主資料庫
          </button>
          <button
            id="exportForPowerBIBtn"
            class="button button-export"
            title="(筆電用) 從主資料庫 all_records.json 匯出給 Power BI 使用的完整 CSV"
          >
            匯出Power BI專用CSV
          </button>
          <button
            id="exportDailyJsonBtn"
            class="button button-info"
            title="(平板用) 匯出今日在平板上新增的所有紀錄"
          >
            匯出本日新紀錄 (JSON)
          </button>
        </div>
      </div>

      <input
        type="file"
        id="historyCsvInput"
        accept=".csv"
        style="display: none"
        multiple
      />
      <input
        type="file"
        id="masterJsonInput"
        accept=".json"
        style="display: none"
      />
      <input
        type="file"
        id="dailyJsonInput"
        accept=".json"
        style="display: none"
      />
      <div id="messageBox" class="message-box" aria-live="polite"></div>

      <div id="common_history">
        <h2 class="section-header">歷史數據檢視</h2>

        <div class="history-filters">
          <div class="filter-group">
            <label for="filterStartDate">日期範圍 (起):</label>
            <input type="date" id="filterStartDate" class="styled-input" />
          </div>
          <div class="filter-group">
            <label for="filterEndDate">日期範圍 (迄):</label>
            <input type="date" id="filterEndDate" class="styled-input" />
          </div>
          <div class="filter-group">
            <label for="filterFieldSelect">篩選數值欄位:</label>
            <select id="filterFieldSelect" class="styled-input">
              <option value="">-- 請選擇欄位 --</option>
            </select>
          </div>
          <div class="filter-group range-group">
            <label>數值範圍:</label>
            <input
              type="number"
              id="filterValueMin"
              class="styled-input"
              placeholder="最小值"
            />
            <span>-</span>
            <input
              type="number"
              id="filterValueMax"
              class="styled-input"
              placeholder="最大值"
            />
          </div>
          <div class="filter-group">
            <label for="filterRtoStatus">RTO 啟用狀態:</label>
            <select id="filterRtoStatus" class="styled-input">
              <option value="all">全部</option>
              <option value="yes">啟用</option>
              <option value="no">停用</option>
            </select>
          </div>
          <!-- ▼▼▼ 在此處新增升溫狀態的篩選器 ▼▼▼ -->
          <div class="filter-group">
            <label for="filterHeatingStatus">升溫啟用狀態:</label>
            <select id="filterHeatingStatus" class="styled-input">
              <option value="all">全部</option>
              <option value="yes">啟用</option>
              <option value="no">停用</option>
            </select>
          </div>
          <!-- ▲▲▲ 新增結束 ▲▲▲ -->
          <div class="filter-group">
            <label for="filterRemarkKeyword">備註關鍵字:</label>
            <input
              type="search"
              id="filterRemarkKeyword"
              class="styled-input"
              placeholder="搜尋備註內容..."
            />
          </div>
          <div class="filter-actions">
            <button id="applyFiltersBtn" class="button button-save">
              套用篩選
            </button>
            <button id="resetFiltersBtn" class="button button-cancel">
              重設篩選
            </button>
          </div>
        </div>
        <div
          id="dashboard-container"
          class="dashboard-container"
          style="display: none"
        >
          <div id="dashboard-rto-chart-container" class="dashboard-chart">
            <canvas id="dashboardRtoChart"></canvas>
          </div>
          <div
            id="dashboard-temp-chart-container"
            class="dashboard-chart"
            style="margin-top: 20px"
          >
            <canvas id="dashboardTempChart"></canvas>
          </div>

          <div class="button-group" style="margin-top: 15px; margin-bottom: 0">
            <button id="exportAirVolumeChartBtn" class="button button-info">
              匯出風量比較圖 (PNG)
            </button>
            <button id="exportTempCompareChartBtn" class="button button-info">
              匯出溫度比較圖 (PNG)
            </button>
          </div>
        </div>
        <div class="table-container">
          <table id="dataTable" class="data-table">
            <thead>
              <tr id="dynamicTableHeaders"></tr>
            </thead>
            <tbody id="dataTableBody"></tbody>
          </table>
          <div id="emptyStateMessage" class="empty-state-message">
            目前沒有歷史數據。請新增數據或匯入 CSV 檔案。
          </div>
        </div>
        <div id="paginationContainer" class="pagination-container"></div>
      </div>
      <div class="chart-container">
        <h2>技術溫測實溫分佈圖</h2>
        <canvas id="temperatureChart"></canvas>
      </div>

      <div class="raw-data-chart-section">
        <h2>匯入原始溫測數據圖表 (CSV)</h2>
        <p>
          請選擇您的溫測機原始 CSV 檔案。圖表將依照第一筆資料為 0
          秒，後續每筆資料遞增 10 秒的規則繪製，X 軸將以分鐘顯示。
        </p>
        <label
          for="rawCsvFileInput"
          class="button button-info file-upload-label"
        >
          <svg
            class="icon"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="17 8 12 3 7 8"></polyline>
            <line x1="12" y1="3" x2="12" y2="15"></line>
          </svg>
          <span>選擇 CSV 檔案</span>
        </label>
        <input
          type="file"
          id="rawCsvFileInput"
          accept=".csv"
          style="display: none"
        />
        <div id="rawChartErrorMessages" aria-live="polite"></div>
        <div id="rawTemperatureChartContainer">
          <canvas id="rawTemperatureChart"></canvas>
        </div>
        <button
          id="exportRawChartButton"
          class="button button-raw-data"
          disabled
        >
          <svg
            class="icon"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line></svg
          ><span>匯出原始圖表 (PNG)</span>
        </button>
      </div>
    </div>

    <div id="confirmModalOverlay" class="modal-overlay">
      <div class="modal-content">
        <p id="confirmModalMessage"></p>
        <div class="modal-buttons">
          <button id="confirmYesBtn" class="button confirm-yes">
            <span>是</span>
          </button>
          <button id="confirmNoBtn" class="button confirm-no">
            <span>否</span>
          </button>
        </div>
      </div>
    </div>
    <div id="imageModalOverlay" class="image-modal-overlay">
      <span class="image-modal-close">&times;</span>
      <div class="image-modal-content">
        <img id="modalImage" src="" alt="測量位置實景照" />
        <div id="modalCaption" class="image-modal-caption"></div>
      </div>
    </div>
    <div id="loadingOverlay" class="modal-overlay">
      <div class="spinner"></div>
    </div>

    <input
      type="file"
      id="historyCsvInput"
      accept=".csv"
      style="display: none"
      multiple
    />
    <input
      type="file"
      id="masterJsonInput"
      accept=".json"
      style="display: none"
    />
    <input
      type="file"
      id="dailyJsonInput"
      accept=".json"
      style="display: none"
    />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script type="module" src="./js/main.js"></script>
  </body>
</html>
